//! Cloud vulnerability assessment
use crate::core::cloud::CloudShield;

pub struct VulnerabilityScanner {
    cloud_shield: CloudShield,
}

impl VulnerabilityScanner {
    pub async fn scan_cloud(&self) -> Vec<Vulnerability> {
        let resources = self.cloud_shield.list_resources().await;
        let mut vulnerabilities = Vec::new();

        for resource in resources {
            let checks = self.run_cis_benchmarks(&resource).await;
            vulnerabilities.extend(checks);
        }
        
        vulnerabilities
    }
}
